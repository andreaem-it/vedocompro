{% extends 'base.html.twig' %}
{% block stylesheets %}
    {% stylesheets
        'css/dropzone.css' filter='cssrewrite'
    %}
    <link rel="stylesheet" href="{{ asset_url }}" />
    {% endstylesheets %}
{% endblock %}
{% block body %}
    <link rel="stylesheet" href="{{ asset('css/jquery.steps.css') }}"/>
    {% include 'template/header.html.twig' %}
    <br><br><br><br>
    <div class="container scrollbar"">
        <div class="row" style="margin-top:-20px">
            <div class="col-lg-1 bg-light-grey"></div>
            <!--<div class="col-lg-3 padding-left-40 bg-light-grey hidden-sm">
                <br><br>
                    <h4>Istruzioni:</h4>
                <br>
                <small>Inserisci il video del prodotto, gira un video esponendo i pregi e difetti di ciò che stai vendendo, è richiesta anche un'immagine che verrà utilizzata per le anteprime nei risultati di ricerca, puoi aggiungerne quante vuoi, assicurati di rispettare i <a href="{{  url('terms-of-service') }}">Termini di Servizio</a>.</small>
                <br><br><br><br><br>
                <small>Scegli un titolo per l'inserzione, cerca di essere più preciso possibile</small>
                <br><br><br><br><br>
                <small>Descrivi il tuo prodotto, elencane pregi e difetti, caratteristiche tecniche e quant'altro ti venga in mente. Se dimentichi qualcosa non preoccuparti, potrai sempre modificare l'inserzione dopo, oppure rispondere alle domande degli utenti</small>
                <br><br><br><br>
                <small>Scegli la categoria del prodotto, fai attenzione a scegliere quella giusta, gli utenti potrebbero non trovare la tua inserzione e potrebbe essere eliminata.</small>
                <br><br><br>
                <small>Dai un prezzo all'oggetto, cerca di essere realista, un prezzo troppo alto non vende.</small>
                <br><br><br>
                <small>Specifica la condizione dell'oggetto, evita di vendere come nuovo un'oggetto usato</small>
                <br><br><br>
                <small>Dove si trova l'oggetto, questi campi vengono normalmente riempiti con i tuoi recapiti forniti nelle impostazioni del profilo. Tuttavia, puoi modificarli nel caso vendi un'oggetto che si trova in un'altra città (es: una casa vacanze)</small>
                <br><br><br><br><br><br><br>
                <small>Questi campi sono opzionali, puoi decidere di specificare alcuni dettagli che verranno visualizzati dinamicamente per ogni categoria diversa.</small>
            </div>-->
            <div class="col-lg-12">
                <br><br>
                <!--<h3>Inserisci Inserzione</h3>-->
                {{ form_start(form) }}
                {% form_theme form 'forms/bootstrap_3_horizontal_layout_new.html.twig' %}
                <div id="wizard">
                    <h2>Descrizione</h2>
                    <section id="step-1">
                        <div class="row">
                            <div class="col-lg-3 hidden-md-down">
                                <br>
                                <small>Scegli un titolo per l'inserzione, cerca di essere più preciso possibile</small>
                                <br><br>
                                <small>Descrivi il tuo prodotto, elencane pregi e difetti, caratteristiche tecniche e quant'altro ti venga in mente. Se dimentichi qualcosa non preoccuparti, potrai sempre modificare l'inserzione dopo oppure rispondere alle domande degli utenti</small>
                                <br><br>
                                <small>Scegli la categoria del prodotto, fai attenzione a scegliere quella giusta, gli utenti potrebbero non trovare la tua inserzione e potrebbe essere eliminata.</small>

                            </div>
                            <div class="col-lg-9" id="form1">
                                <label for="form_name">Nome Oggetto</label>
                                {{ form_widget(form.name) }}
                                <small class="hidden-md-up form-text text-muted">Scegli un titolo per l'inserzione, cerca di essere più preciso possibile</small>
                                <br>
                                <label for="form_description">Descrizione Oggetto</label>
                                {{ form_widget(form.description) }}
                                <small class="hidden-md-up form-text text-muted">Descrivi il tuo prodotto, elencane pregi e difetti, caratteristiche tecniche e quant'altro ti venga in mente. Se dimentichi qualcosa non preoccuparti, potrai sempre modificare l'inserzione dopo, oppure rispondere alle domande degli utenti</small>
                                <br>
                                <label for="form_cateogry">Categoria</label>
                                {{ form_widget(form.category) }}
                                <small class="hidden-md-up form-text text-muted">Scegli la categoria del prodotto, fai attenzione a scegliere quella giusta, gli utenti potrebbero non trovare la tua inserzione e potrebbe essere eliminata.</small>
                            </div>
                        </div>

                    </section>
                    <h2>Prezzo e Ubicazione</h2>
                    <section id="step-2">
                        <div class="row">
                            <div class="col-lg-3 hidden-md-down">
                                <small>Dai un prezzo all'oggetto, cerca di essere realista, un prezzo troppo alto non vende.</small>
                                <br><br>
                                <small>Specifica la condizione dell'oggetto, evita di vendere come nuovo un'oggetto usato</small>
                                <br><br>
                                <small>Dove si trova l'oggetto, questi campi vengono normalmente riempiti con i tuoi recapiti forniti nelle impostazioni del profilo. Tuttavia, puoi modificarli nel caso vendi un'oggetto che si trova in un'altra città (es: una casa vacanze)</small>
                            </div>
                            <div class="col-lg-9" id="form2">
                                <label for="form_price">Prezzo</label>
                                {{ form_widget(form.price) }}
                                <small class="hidden-md-up form-text text-muted">Dai un prezzo all'oggetto, cerca di essere realista, un prezzo troppo alto non vende.</small>
                                <br>
                                <label for="form_condition">Condizione</label>
                                {{ form_widget(form.objCondition) }}
                                <small class="hidden-md-up form-text text-muted">Specifica la condizione dell'oggetto, evita di vendere come nuovo un'oggetto usato</small>
                                <br>
                                <div class="row">
                                    <div class="col">
                                        <label for="form_location">Dove si trova</label>
                                        {{ form_widget(form.location) }}
                                    </div>
                                    <div class="col">
                                        <label for="form_price">Regione</label>
                                        {{ form_widget(form.region) }}
                                    </div>
                                </div>
                                <small class="hidden-md-up form-text text-muted">Dove si trova l'oggetto, questi campi vengono normalmente riempiti con i tuoi recapiti forniti nelle impostazioni del profilo. Tuttavia, puoi modificarli nel caso vendi un'oggetto che si trova in un'altra città (es: una casa vacanze)</small>
                            </div>
                        </div>
                    </section>
                    <h2>Video e Foto</h2>
                    <section id="step-3">
                        <div class="row">
                            <div class="col-lg-3 hidden-md-down">
                                <small> massimo 200 MB, in formato AVI, MOV, MP4 o M4V.<strong>ATTENZIONE:</strong>Carica un video con orientamento orizzontale, eventuali video orientati in verticale verranno bocciati. Assicurati di rispettare i <a href="{{  url('terms-of-service') }}">Termini di Servizio</a>.</small>
                                <br><br>
                                <small>Un consiglio, leggi le nostre <a href="{{ url('guidelines') }}" target="_blank">Linee Giuda</a> per un video di successo!</small>
                                {{ form_widget(form.video) }}
                            </div>
                            <div class="col-lg-9">
                                <div id="dZUpload" class="dropzone">
                                    <div class="dz-default dz-message">
                                        Carica video e foto cliccando qui o trascinandoli sopra
                                    </div>
                                </div>
                                <div class="checkbox">
                                    <label><input type="checkbox" value="tosAccept" required />&nbsp; Accetto i <a href="{{  url('terms-of-service') }}">Termini di Servizio</a></label>
                                </div>
                                <small class="hidden-md-up form-text text-muted">Inserisci il video del prodotto, gira un video esponendo i pregi e difetti di ciò che stai vendendo, massimo 200 MB, in formato AVI, MOV, MP4 o M4V. <br><strong>ATTENZIONE:</strong>Carica un video con orientamento orizzontale, eventuali video orientati in verticale verranno bocciati. <br> Assicurati di rispettare i <a href="{{  url('terms-of-service') }}">Termini di Servizio</a>.</small>
                                <br>
                                <small class="hidden-md-up form-text text-muted">Un consiglio, leggi le nostre <a href="{{ url('guidelines') }}" target="_blank">Linee Giuda</a> per un video di successo!</small>
                                <script src="https://cdn.rawgit.com/enyo/dropzone/master/dist/min/dropzone.min.js"></script>
                                <script>
                                    $("#dZUpload").dropzone({
                                        url: "/ajax/admin/admin.acceptVideo.php",
                                        maxFilesize: 200000000,
                                        acceptedFiles: ".mp4,.m4v,.mov,.avi,.wmv,.3gp",
                                        addRemoveLinks: true,
                                        dataType: "HTML",
                                        data: { id: '' },
                                        createImageThumbnails: true,
                                        maxThumbnailFilesize: 100,
                                        timeout: 1800000,
                                        maxFiles: 1,
                                        success: function (file, response, data) {
                                            var imgName = response;
                                            file.previewElement.classList.add("dz-success");
                                            console.log(imgName);
                                            $('#form_video').val(imgName);
                                        },
                                        error: function (file, response) {
                                            file.previewElement.classList.add("dz-error");
                                        }
                                    });
                                    Dropzone.autoDiscover = false;
                                    Dropzone.prototype.defaultOptions.dictRemoveFile = "Rimuovi file";
                                    Dropzone.prototype.defaultOptions.dictCancelUpload = "Annulla";
                                    Dropzone.prototype.defaultOptions.dictFileTooBig = "Il file è troppo grande!";
                                    Dropzone.prototype.defaultOptions.dictCancelUploadConfirmation = "Sei sicuro di voler eliminare il file?";
                                    Dropzone.prototype.defaultOptions.dictMaxFilesExceeded = "Puoi inserire soltanto un video.";
                                </script>
                            </div>
                        </div>

                        {{ form_end(form) }}
                    </section>
                    <h2>Fine</h2>
                    <section class="text-center success">
                        <img src="{{ asset('img/svg/check.svg') }}" alt="check"/>
                        <br><br>
                        <h3>Fatto!</h3>
                        <br>
                        <p>Cliccando Fine la tua Inserzione verrà inserita e sarà in attesa di moderazione da parte del nostro staff!</p>
                        <p>Solitamente questo impiega poco ma in casi eccezionali può impiegare fino a 48 ore.</p>
                        <p>Verrai informato appena sarà disponibile tramite e-mail</p>

                    </section>
                </div>
                <br><br>


            </div>
        </div>
    </div>
    <style>
        .dropzone {
            background-image: url({{ asset('img/upload-1-512.png') }})!important;
            background-position: center center!important;
            background-repeat: no-repeat!important;
            background-size: contain!important;
            background-color: transparent;
            border: 0px;
        }
        .dz-preview.dz-image-preview {
            background-color: transparent!important;
        }
        #form_save {
            visibility: hidden;
        }
    </style>
    <script src='{{ asset('js/jquery.steps.min.js') }}' type="text/javascript"></script>
    <script>
        var form = $("#wizard");
        var step = 1;
        form.steps({
            headerTag: "h2",
            bodyTag: "section",
            autoFocus: true,
            transitionEffect: "fade",
            /*onStepChanging: function (event, currentIndex, newIndex)
            {
                if (validate(currentIndex) === true) {
                    form.find(".body:eq(" + newIndex + ") label.error").remove();
                    form.find(".body:eq(" + newIndex + ") .error").removeClass("error");
                    return true;
                } else {
                    if(invalid(currentIndex) === true) {
                        $("#form" + currentIndex + ":input").addClass('error');
                        return false;
                    }
                }
                if (currentIndex < newIndex)
                {
                    form.find(".body:eq(" + newIndex + ") label.error").remove();
                    form.find(".body:eq(" + newIndex + ") .error").removeClass("error");
                }

            },*/
            onStepChanging: function(e, currentIndex, newIndex) {
                if(validate(currentIndex) === true) {
                    return true;
                } else return true;
            },
            onStepChanged: function (event, currentIndex, priorIndex)
            {

            },
            onFinishing: function (event, currentIndex)
            {
                if(isValid(step) === true) {
                    return true;
                } else {
                    return true;
                }

            },
            onFinished: function (event, currentIndex)
            {
                $('#form_save').click();
            }
        });
        function validate(step){
            var step = step -1;
            var div = $("#form" + step + "");
            $(div).find("input[type = 'text']").each(function() {
                if(this.value === "") {
                    return false;
                }
            });
        }
        function invalid(step){
            var div = $("#wizard-p-" + step + "");
            $(div).find("input").each(function() {
                if(null !== this.value) {
                    return true;
                }
            });
        }
        function isValid(step) {
            $("#wizard-p-" + step + ":input").each(function() {
                var element = $(this);
                if (element.val() === "") {
                    isValid = false;
                }
                console.log(step);
            })
        }

    </script>
{% include 'template/footer.html.twig'%}

{% endblock %}
